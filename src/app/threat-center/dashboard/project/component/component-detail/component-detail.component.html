  <div *ngIf='obsComponent | async as component;'>

    <div class="row" style="margin-bottom:20px">
      <div class="col-md-12" *ngIf="!!breadcumDetail">
        <span style="font-size:15px">
            <a class="cursor-pointer" [routerLink]="['/dashboard/entity']"><i class="far fa-building"></i>&nbsp;{{breadcumDetail.SelectedEntity.name}}</a> /
            <a class="cursor-pointer" (click)="gotoProject()">{{breadcumDetail.SelectedProject.name}}</a> /
            <a  *ngIf="breadcumDetail.SelectedLicense && licenseId" class="cursor-pointer" (click)="gotoLicense()">{{breadcumDetail.SelectedLicense.name}}/</a> 
            <span style="color: #ffffff;">{{component.name}}</span>
          </span>
      </div>

    </div>

    <div class="row" style="margin-bottom:40px">
      <div class="col-md-6">
        <h3><span style="font-size:15px">{{component.group}}</span> | {{component.name}}</h3>
        Version: <span title="Info" class="badge m-r-5 badge-light-primary">{{component.version}}</span>
        Released: <span title="Info" class="badge m-r-5 badge-light-primary">Oct 10, 2017</span>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <ngb-tabset type="pills" [activeId]="stateService.component_tabs_selectedTab" (tabChange)="onTabChange($event)">

          <!-- VULNERABILITIES TAB -->
          <ngb-tab title="Vulnerabilities" id="vulnerabilities">
            <ng-template ngbTabContent>
              <perfect-scrollbar [style.max-height]="'650px'">
                <p-table #dt [columns]="vulnerabilityColumns" [value]="vulnerabilityDetails.edges" [paginator]="false" [rows]="50"
                         tableStyleClass="table table-striped table-bordered table-hover dataTable no-footer"
                         [autoLayout]="true" [globalFilterFields]="['vulnId','cwe.name']">

                  <ng-template pTemplate="caption">
                    <div style="display: flex;text-align: left">
                      <div style="flex: 50%;font-weight:bold">

                      </div>
                      <div style="flex: 50%;text-align: right">
                        <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
                        <input type="text" class="form-control" pInputText size="50" placeholder="Global Filter" (input)="dt.filterGlobal($event.target.value, 'contains')" style="width:auto;display:inline">
                      </div>
                    </div>
                  </ng-template>
                  <ng-template pTemplate="header" let-columns>
                    <tr>
                      <th *ngFor="let col of columns" >
                        {{col}}
                      </th>
                    </tr>
                  </ng-template>

                  <ng-template pTemplate="body" let-vulnerability>
                    <tr (click)="gotoOtherDetailsPage(vulnerability?.node.vulnerabilityId,'vulnerability')" class="cursor-pointer">
                      <td><span class="badge m-r-5 badge-light-info">{{vulnerability?.node.source}}</span> {{vulnerability?.node.vulnId}}</td>
                      <td><span *ngIf="vulnerability?.node.cwe"> CWE-{{vulnerability?.node.cwe?.cweId}} : {{vulnerability?.node.cwe?.name}}</span></td>
                      <td>{{vulnerability?.node.severity}}</td>
                      <td>{{vulnerability?.node.cvssV2BaseScore}}</td>
                      <td>{{vulnerability?.node.cvssV3BaseScore | number : '1.1-1'}}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </perfect-scrollbar>

              <div class="row text-center" *ngIf="vulnerabilityDetails.edges.length == 0" style="margin-top: 20px;">
                <h5 class="col-12">{{component.name}} have no vulnerabilities yet.</h5>
              </div>

              <div class="col-sm-12" *ngIf="vulnerabilityDetails.edges.length >= 1">
                <mat-paginator [hidePageSize]="false" [disabled]="false" [length]="vulnerabilityDetails?.totalCount" [pageSize]="defaultPageSize"
                  [pageSizeOptions]="[25, 50, 100]" (page)="changePage($event)">
                </mat-paginator>
              </div>

            </ng-template>
          </ngb-tab>

          <!-- LICENSES TAB -->
          <ngb-tab title="Licenses" id="licenses">
            <ng-template ngbTabContent>

              <div style="display: flex;">
                <div class="card m-3" style="flex: 33%;flex-grow: 0;" *ngFor="let license of component.licenses.edges">
                  <div class="card-body" (click)="gotoOtherDetailsPage(license.node.licenseId,'license')">
                    <h6 class="card-title">{{license.node.name}}</h6>
                      <div class="card p-2 m-3">
                        <form>
                          <div class="form-group row  p-l-5">
                            <label class="col-sm-12 col-form-label">Category</label>
                            <div class="col-xl-12">
                              <span *ngIf="license.node.category === 'Copyleft Strong'" title="Copyleft Strong" class="badge m-r-5 badge-light-danger">COPYLEFT STRONG</span>
                              <span *ngIf="license.node.category === 'Copyleft Weak'" title="Copyleft Weak" class="badge m-r-5 badge-light-warning">COPYLEFT WEAK</span>
                              <span *ngIf="license.node.category === 'Copyleft Partial'" title="Copyleft Partial" class="badge m-r-5 badge-light-warning">COPYLEFT PARTIAL</span>
                              <span *ngIf="license.node.category === 'Copyleft Limited'" title="Copyleft Limited" class="badge m-r-5 badge-light-warning">COPYLEFT LIMITED</span>
                              <span *ngIf="license.node.category === 'Copyleft'" title="Copyleft" class="badge m-r-5 badge-light-warning">COPYLEFT</span>
                              <span *ngIf="license.node.category === 'Permissive'" title="Permissive" class="badge m-r-5 badge-light-success">PERMISSIVE</span>
                            </div>
                          </div>
                          <div class="form-group row  p-l-5">
                            <label for="spdx" class="col-sm-12 col-form-label">SPDX</label>
                            <div class="col-xl-12">
                              <input type="text" class="form-control" id="spdx" readonly placeholder="{{license.node.spdxId}}">
                            </div>
                          </div>publicationYear
                          <div class="form-group row  p-l-5">
                            <label for="style" class="col-sm-12 col-form-label">Style</label>
                            <div class="col-xl-12">
                              <input type="text" class="form-control" id="style" readonly placeholder="{{license.node.style}}">
                            </div>
                          </div>
                          <div class="form-group row  p-l-5">
                            <label for="publicationYear" class="col-sm-12 col-form-label">Publication Year</label>
                            <div class="col-xl-12">
                              <input type="text" class="form-control" id="publicationYear" readonly placeholder="{{license.node.publicationYear}}">
                            </div>
                          </div>

                        </form>
                      </div>

                  </div>
                </div>
              </div>
            </ng-template>
          </ngb-tab>

          <!-- REPOSITORIES TAB -->
          <ngb-tab title="Repositories" id="repositories">
            <ng-template ngbTabContent>
              <div class="row" style="padding:20px 0px 20px 0px;margin-left:5px;margin-right:5px">
                <div class="col-md-6">
                  <app-card [hidHeader]="true" cardClass="mb-5" blockClass="pb-0">
                    <div>
                      <div style="width:40%;float:left;">
                        <div>
                          <div style="width:50%;float:left;margin-bottom:5px;font-size:16px"><span class="badge m-r-5 badge-light-info">{{component.repositoryMeta.repositoryType}}</span></div>
                          <div style="width:50%;float:left;text-align:right;margin-bottom:5px;font-size:16px"><span class="badge m-r-5 badge-light-success">BINARY</span></div>
                        </div>
                        <div class="form-group">
                          <label>Namespace</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.namespace}}">
                        </div>
                        <div class="form-group">
                          <label>Name</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.name}}">
                        </div>
                        <div class="form-group">
                          <label>Latest Version</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.latestVersion}}">
                        </div>
                        <div class="form-group">
                          <label>Published</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.published | date :'MMMM d, y'}}">
                        </div>
                        <div class="form-group">
                          <label>Last Checked</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.lastCheck | date :'MMMM d, y'}}">
                        </div>
                      </div>
                      <div style="width:58%;float:right;">
                        <perfect-scrollbar [style.max-height]="'400px'">
                          <p-table #dtBinary [columns]="releaseCols" [value]="binaryReleases"
                                   [scrollable]="true" [rows]="25" [style]="{width:'250px'}" scrollHeight="250px"
                                   [virtualScroll]="true" [virtualRowHeight]="34" [loading]="binaryLoading" [lazy]="true" (onLazyLoad)="loadBinaryReleasesLazy($event)"
                                   [filterDelay]="0" [globalFilterFields]="['version', 'releaseDate']"
                                   tableStyleClass="table table-striped table-bordered table-hover dataTable no-footer">

                            <ng-template pTemplate="caption">
                              <div style="text-align:right;margin-bottom:10px">
                                <label>
                                  <input type="text" pInputText size="50" placeholder="Filter"
                                         (input)="dtBinary.filterGlobal($event.target.value, 'contains')"
                                         style="width:160px;display:inline" class="form-control">
                                </label>
                              </div>
                            </ng-template>
                            <ng-template pTemplate="header">
                              <tr>
                                <th pSelectableRow="version">Version</th>
                                <th pSelectableRow="releaseDate">Release Date</th>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-binaryRelease>
                              <tr *ngIf="binaryRelease.cvssV3 != null; else noCvssB" [ngClass]="{'badge m-l-5 badge-light-danger': binaryRelease.cvssV3.severity === 'CRITICAL',
                              'badge m-l-5 badge-light-danger': binaryRelease.cvssV3.severity === 'HIGH',
                              'badge m-l-5 badge-light-warning': binaryRelease.cvssV3.severity === 'MEDIUM',
                              'badge m-l-5 badge-light-primary': binaryRelease.cvssV3.severity === 'LOW',
                              'badge m-l-5 badge-light-success': binaryRelease.cvssV3.severity === 'INFO'
                              }" [placement]="'top'" ngbTooltip="{{binaryRelease.cvssV3.cveId}} : {{binaryRelease.cvssV3.cvssV3BaseScore}} : {{binaryRelease.cvssV3.severity}}">
                                <td>{{binaryRelease.version}}</td>
                                <td>{{binaryRelease.releaseDate}}</td>
                              </tr>
                              <ng-template #noCvssB>
                                <tr>
                                  <td style>{{binaryRelease.version}}</td>
                                  <td style>{{binaryRelease.releaseDate}}</td>
                                </tr>
                              </ng-template>
                            </ng-template>
                          </p-table>
                        </perfect-scrollbar>
                      </div>
                    </div>
                  </app-card>
                </div>
                <div class="col-md-6">
                  <app-card [hidHeader]="true" cardClass="mb-3" blockClass="pb-0">
                    <div>
                      <div style="width:40%;float:left;">
                        <div>
                          <div style="width:50%;float:left;margin-bottom:5px;font-size:16px"><span class="badge m-r-5 badge-light-info">{{sourcePurlType.toUpperCase()}}</span></div>
                          <div style="width:50%;float:left;text-align:right;margin-bottom:5px;font-size:16px"><span class="badge m-r-5 badge-light-success">SOURCE</span></div>
                        </div>
                        <div class="form-group">
                          <label>Namespace</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.namespace}}">
                        </div>
                        <div class="form-group">
                          <label>Name</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.name}}">
                        </div>
                        <div class="form-group">
                          <label>Latest Version</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.latestVersion}}">
                        </div>
                        <div class="form-group">
                          <label>Published</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.published | date :'MMMM d, y'}}">
                        </div>
                        <div class="form-group">
                          <label>Last Checked</label>
                          <input class="form-control" disabled placeholder="Text" value="{{component.repositoryMeta?.lastCheck | date :'MMMM d, y'}}">
                        </div>
                      </div>
                      <div style="width:58%;float:right;">
                        <perfect-scrollbar [style.max-height]="'400px'">
                          <p-table #dtSource [columns]="releaseCols" [value]="sourceReleases"
                                   [scrollable]="true" [rows]="25" [style]="{width:'350px'}" scrollHeight="250px"
                                   [virtualScroll]="true" [virtualRowHeight]="34" [loading]="sourceLoading" [lazy]="true" (onLazyLoad)="loadSourceReleasesLazy($event)"
                                   [filterDelay]="0" [globalFilterFields]="['version', 'releaseDate']"
                                   tableStyleClass="table table-striped table-bordered table-hover dataTable no-footer">

                            <ng-template pTemplate="caption">
                              <div style="text-align:right;margin-bottom:10px">
                                <label>
                                  <input type="text" pInputText size="50" placeholder="Filter"
                                         (input)="dtSource.filterGlobal($event.target.value, 'contains')"
                                         style="width:160px;display:inline" class="form-control">
                                </label>
                              </div>
                            </ng-template>
                            <ng-template pTemplate="header">
                              <tr>
                                <th pSelectableRow="version">Version</th>
                                <th pSelectableRow="releaseDate">Release Date</th>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-sourceRelease>
                              <tr *ngIf="sourceRelease.cvssV3 != null; else noCvssS" [ngClass]="{'badge m-l-5 badge-light-danger': sourceRelease.cvssV3.severity === 'CRITICAL',
                              'badge m-l-5 badge-light-danger': sourceRelease.cvssV3.severity === 'HIGH',
                              'badge m-l-5 badge-light-warning': sourceRelease.cvssV3.severity === 'MEDIUM',
                              'badge m-l-5 badge-light-primary': sourceRelease.cvssV3.severity === 'LOW',
                              'badge m-l-5 badge-light-success': sourceRelease.cvssV3.severity === 'INFO'
                              }" [placement]="'top'" ngbTooltip="{{sourceRelease.cvssV3.cveId}} : {{sourceRelease.cvssV3.cvssV3BaseScore}} : {{sourceRelease.cvssV3.severity}}">
                                <td style>{{sourceRelease.version}}</td>
                                <td style>{{sourceRelease.releaseDate}}</td>
                              </tr>
                              <ng-template #noCvssS>
                                <tr>
                                  <td style>{{sourceRelease.version}}</td>
                                  <td style>{{sourceRelease.releaseDate}}</td>
                                </tr>
                              </ng-template>
                            </ng-template>
                          </p-table>
                        </perfect-scrollbar>
                      </div>
                    </div>

                  </app-card>
                </div>
              </div>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
      </div>
    </div>
  </div>

