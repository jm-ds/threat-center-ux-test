<div style="width: 100%;">
  <div class = "card pr-2 no-border">
    <div *ngFor="let condition of parentGroup.groups[0].conditions" class="ml-4">
      <div class="card p-2 no-border mb-0">
        <div class="form-group row" >
          <div class="col-sm-3">
            <select [(ngModel)]="condition.conditionName"  (ngModelChange)="onChangeName($event, condition)"
            [disabled]="readonly"  class="form-control form-control-sm input-sm ng-select custom-select" >
              <option *ngFor="let cond of getConditionTypeNames(categories.mainConditions.get(condition.conditionType).conditionMetadatas)" [ngValue]="cond.code">{{ cond.title }}</option> 
            </select>
          </div>
          <div class="col-sm-1" stype="min-width: 70px;">
            <select [(ngModel)]="condition.operator" 
            [disabled]="readonly"  class="form-control form-control-sm input-sm ng-select custom-select" >
              <option *ngFor="let operator of getOperators('MAIN', condition.conditionType, condition.conditionName)" [ngValue]="operator.code">{{ operator.name }}</option> 
            </select>
          </div>

          <div class="col-sm-7">
            <select  *ngIf="condition.conditionType && condition.conditionName && categories.mainConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).inputType==='CMB'" 
              [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"
            [disabled]="readonly" class="form-control form-control-sm ng-select custom-select col-sm-12" style="overflow-y: auto;" >
              <option *ngFor="let item of categories.mainConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).values" [ngValue]="item.code">{{ item.name }}</option> 
            </select> 

            <input *ngIf="condition.conditionType && condition.conditionName && categories.mainConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).inputType==='STR'"
            [disabled]="readonly" class="form-control col-sm-12" [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"/>

            <input *ngIf="condition.conditionType && condition.conditionName && categories.mainConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).inputType==='NUM'"
            [disabled]="readonly" class="form-control col-sm-12" type="number" [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"/>

            <select  *ngIf="condition.conditionType && condition.conditionName && categories.mainConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).inputType==='CMM'" 
              [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"
            [disabled]="readonly" multiple class="form-control form-control-sm ng-select custom-select col-sm-12" style="overflow-y: auto;" >
              <option *ngFor="let item of categories.mainConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).values" [ngValue]="item.code">{{ item.name }}</option> 
            </select> 

          </div>

          <div class="col-sm-1">
            <button *ngIf="!readonly && ! isLastMainCondition(condition)" type="button" class="btn btn-icon float-right" title="Remove condition" (click)="this.removeCondition(parentGroup.groups[0], condition)" 
            style="color: #c9d0d5;">
              <i class="feather icon-x" style="font-size: 12px; font-weight: 800;"></i>
            </button>
          </div>  
        </div>  
        <div class="row ml-4">
          <div class="col-sm-1">
            <button *ngIf="condition.logicalOperator" type="button" class="btn btn-outline-secondary" 
              [disabled]= "readonly"
              (click)="condition.logicalOperator === 'AND'? condition.logicalOperator = 'OR': condition.logicalOperator = 'AND'" 
              style="color: #c9d0d5;">
              {{condition.logicalOperator}}
            </button>
          </div>
        </div>
  
      </div>
    </div>  
    <div class="row ml-4">
      <div class="col-sm-3">
        <button *ngIf="!readonly" type="button" class="btn btn-outline-secondary" title="Add condition" (click)="this.addCondition(parentGroup.groups[0])" 
        style="color: #c9d0d5;">
          <i class="feather icon-plus" style="font-size: 14px; font-weight: 800;"></i> ADD CONDITION
        </button>
      </div>
    </div>
  </div>  

  <!-- Subordinate conditions -->

  <div class = "card pr-2 no-border">
    <div *ngIf="!readonly || parentGroup.groups[1].conditions.length>0"class="mt-2 ml-2 mb-2 h5">
      AND Subordinate Conditions
    </div>  
        <div *ngFor="let condition of parentGroup.groups[1].conditions" class="ml-4">
          <div class="card p-2 no-border mb-0">
            <div class="form-group row" >
              <div class="col-sm-3">
                <select [(ngModel)]="condition.conditionName"  (ngModelChange)="onChangeSubordinateName($event, condition)"
                [disabled]="readonly"  class="form-control form-control-sm input-sm ng-select custom-select" >
                  <option *ngFor="let cond of subordinateConditionListItems" [ngValue]="cond.code" [disabled]="cond.isType"
                  [style.color] = "cond.isType ? '#8a8f94' : 'white'"
                  [style.background-color] = "cond.isType ? 'white' : '#8a8f94'"
                  >{{ cond.title }}</option> 
                </select>
              </div>
    
              <div class="col-sm-1">
                <select [(ngModel)]="condition.operator" 
                [disabled]="readonly"  class="form-control form-control-sm input-sm ng-select custom-select" >
                  <option *ngFor="let operator of getOperators('SUBORDINATE', condition.conditionType, condition.conditionName)" [ngValue]="operator.code">{{ operator.name }}</option> 
                </select>
              </div>
    
              <div class="col-sm-7">
                <select  *ngIf="condition.conditionType && condition.conditionName && categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName)?.inputType==='CMB'" 
                  [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"
                [disabled]="readonly" class="form-control form-control-sm ng-select custom-select col-sm-12" style="overflow-y: auto;" >
                  <option *ngFor="let item of categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).values" [ngValue]="item.code">{{ item.name }}</option> 
                </select> 
    
                <input *ngIf="condition.conditionType && condition.conditionName && categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName)?.inputType==='STR'"
                [disabled]="readonly" class="form-control col-sm-12" [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"/>
    
                <input *ngIf="condition.conditionType && condition.conditionName && categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName)?.inputType==='NUM'"
                [disabled]="readonly" class="form-control col-sm-12" type="number" [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"/>
    
                <select  *ngIf="condition.conditionType && condition.conditionName && categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName)?.inputType==='CMM'" 
                  [ngModel]="getConditionValue(condition)" (ngModelChange)="onChangeValue($event, condition)"
                  [disabled]="readonly" multiple class="form-control form-control-sm ng-select custom-select col-sm-12" style="overflow-y: auto;" >
                  <option *ngFor="let item of categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName).values" [ngValue]="item.code">{{ item.name }}</option> 
                </select> 
                <mat-chip-list #tagList *ngIf="condition.conditionType && condition.conditionName && categories.subordinateConditions.get(condition.conditionType).conditionMetadatas.get(condition.conditionName)?.inputType==='CHP'" >
                  <mat-chip *ngFor="let tag of condition.strValue?.split(',')" 
                           removable="true">
                    {{tag}}
                    <button *ngIf="!readonly" type="button" class="btn btn-icon float-right" title="Remove Tag" (click)="removeProjectTag(condition, tag)" 
                    style="color: #c9d0d5; padding: unset;">
                      <i class="feather icon-x" style="font-weight: 800;"></i>
                    </button>
                  </mat-chip>
                  <input placeholder="Tags..." class = "next-dark form-control"
                         [matChipInputFor]="tagList"
                         (matChipInputTokenEnd)="addProjectTag(condition, $event)">
                </mat-chip-list>                

    
              </div>
    
              <div class="col-sm-1">
                <button *ngIf="!readonly" type="button" class="btn btn-icon float-right" title="Remove condition" (click)="this.removeCondition(parentGroup.groups[1], condition)" 
                style="color: #c9d0d5;">
                  <i class="feather icon-x" style="font-size: 12px; font-weight: 800;"></i>
                </button>
                </div>  
            </div>  
            <div class="row ml-4">
              <div class="col-sm-1">
              <button *ngIf="condition.logicalOperator" type="button" class="btn btn-outline-secondary" 
              (click)="condition.logicalOperator === 'AND'? condition.logicalOperator = 'OR': condition.logicalOperator = 'AND'" 
              style="color: #c9d0d5;">
              {{condition.logicalOperator}}
              </button>
              </div>
            </div>
      
          </div>
        </div>  
        <div class="row ml-4">
          <div class="col-sm-3">
          <button *ngIf="!readonly" type="button" class="btn btn-outline-secondary" title="Add condition" (click)="this.addCondition(parentGroup.groups[1])" 
          style="color: #c9d0d5;">
            <i class="feather icon-plus" style="font-size: 14px; font-weight: 800;"></i> ADD CONDITION
          </button>
          </div>
        </div>
      </div>  
    
</div>
